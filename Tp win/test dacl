$group = "Utilisateurs du domaine"  # Remplace si le nom est différent
$user = "ad_pwd_reset"

# Récupération du SID de l'utilisateur
$userSID = (Get-ADUser -Identity $user).SID

# Récupération du DACL actuel du groupe
$groupACL = Get-Acl -Path "AD:\$group"

# Création de la règle d'autorisation
$rule = New-Object System.DirectoryServices.ActiveDirectoryAccessRule(
    $userSID,
    "ExtendedRight",
    "Allow",
    [GUID]"00299570-246d-11d0-a768-00aa006e0529"
)

# Application de la nouvelle règle
$groupACL.AddAccessRule($rule)
Set-Acl -Path "AD:\$group" -AclObject $groupACL

Write-Host "Droit ForceChangePassword ajouté à ad_pwd_reset sur $group" -ForegroundColor Green
